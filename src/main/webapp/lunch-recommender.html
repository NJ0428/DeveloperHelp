<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>점심 추천기</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f4f4f4;
            color: #333;
        }
        nav {
            width: 100%;
            background-color: #333;
            overflow: hidden;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        nav a {
            float: left;
            display: block;
            color: white;
            text-align: center;
            padding: 14px 20px;
            text-decoration: none;
            transition: background-color 0.3s;
        }
        nav a:hover {
            background-color: #005bb5;
            color: black;
        }
        .container {
            padding: 20px;
            max-width: 80%;
            margin: 40px auto;
            background-color: #fff;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            border-radius: 8px;
            text-align: center;
        }
        h1 {
            text-align: center;
            color: #333;
        }
        #recommendation {
            font-size: 24px;
            margin-top: 20px;
            padding: 20px;
            background-color: #e0f7fa;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            display: inline-block;
            width: 100%;
        }
        input, button {
            margin-top: 20px;
            padding: 12px 24px;
            font-size: 16px;
            background-color: #ffffff;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        button:hover {
            background-color: #005bb5;
        }
        table {
            width: 100%;
            margin-top: 20px;
            border-collapse: collapse;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }
        table th, table td {
            border: 1px solid #ddd;
            padding: 12px;
            text-align: left;
        }
        table th {
            background-color: #0073e6;
            color: white;
        }
        table tr:nth-child(even) {
            background-color: #f9f9f9;
        }
    </style>
</head>
<body>
    <nav>
        <a href="index.html">Home</a>
        <a href="json-viewer.html">JSON 뷰어</a>
        <a href="xml-to-json.html">XML -> JSON 변환기</a>
        <a href="json-to-xml.html">JSON -> XML 변환기</a>
        <a href="url-encoder.html">URL 인코딩</a>
        <a href="url-decoder.html">URL 디코딩</a>        
        <a href="variable-suggester.html">변수 추천기</a>
        <a href="http-header-parser.html">HTTP 헤더 파서</a>
        <a href="url-parameter-viewer.html">URL 파라미터 뷰어</a>
        <a href="html-tag-analyzer.html">HTML 태그 분석기</a>
        <a href="lunch-recommender.html">점심 추천기</a>
    </nav>

    <div class="container">
        <h1>오늘의 점심은?</h1>
        <div id="recommendation">무엇을 드실지 고민이신가요? 버튼을 눌러 추천을 받아보세요!</div>
        <button style="background-color: chartreuse;" onclick="recommendLunch()">점심 추천</button>
        <input type="text" id="restaurantInput" placeholder="음식점을 입력하세요">
        <button onclick="saveLunch()" style="background-color: cornflowerblue;">점심 저장</button>

        <h2>이전의 점심 기록</h2>
        <table>
            <thead>
                <tr>
                    <th>날짜</th>
                    <th>요일</th>
                    <th>음식</th>
                    <th>음식점</th>
                    <th>수정</th>
                    <th>삭제</th>
                </tr>
            </thead>
            <tbody id="historyTableBody">
                <!-- 이전의 점심 기록이 여기에 표시됩니다 -->
            </tbody>
        </table>
    </div>

    <script>
        const lunchHistory = JSON.parse(localStorage.getItem('lunchHistory')) || [];

        function loadHistory() {
            const tableBody = document.getElementById('historyTableBody');
            tableBody.innerHTML = '';

            lunchHistory.forEach((entry, index) => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${entry.date}</td>
                    <td>${entry.day}</td>
                    <td><input type="text" value="${entry.food}" id="food-${index}"></td>
                    <td><input type="text" value="${entry.restaurant}" id="restaurant-${index}"></td>
                    <td><button onclick="updateLunch(${index})">수정</button></td>
                    <td><button onclick="deleteLunch(${index})">삭제</button></td>
                `;
                tableBody.appendChild(row);
            });
        }

        function recommendLunch() {
            const lunchOptions = [
                '새우볶음밥', '롯데리아', '돈까스', '제육볶음', '된장찌개',
                '불고기', '냉면', '순두부찌개', '카레라이스', '짜장면',
                '짬뽕', '라면', '김밥', '우동', '떡볶이',
                '치킨', '피자', '햄버거', '샌드위치', '파스타'
            ];

            const weights = calculateWeights(lunchOptions);
            const recommendation = weightedRandomSelect(lunchOptions, weights);
            document.getElementById('recommendation').textContent = `오늘의 점심 추천: ${recommendation}`;
        }

        function calculateWeights(options) {
            const weights = options.map(option => {
                // 최근에 선택된 횟수를 계산
                const count = lunchHistory.filter(entry => entry.food === option).length;
                // 기본 가중치에서 이전 선택 횟수를 뺀 값을 사용 (선택 횟수가 많을수록 가중치가 낮아짐)
                return Math.max(1, 5 - count);
            });
            return weights;
        }

        function weightedRandomSelect(options, weights) {
            const totalWeight = weights.reduce((acc, weight) => acc + weight, 0);
            let random = Math.random() * totalWeight;
            for (let i = 0; i < options.length; i++) {
                if (random < weights[i]) {
                    return options[i];
                }
                random -= weights[i];
            }
        }

        function saveLunch() {
            const recommendation = document.getElementById('recommendation').textContent.replace('오늘의 점심 추천: ', '').trim();
            const restaurant = document.getElementById('restaurantInput').value.trim();

            if (!recommendation || recommendation === '무엇을 드실지 고민이신가요? 버튼을 눌러 추천을 받아보세요!') {
                alert('먼저 점심을 추천받으세요.');
                return;
            }

            if (!restaurant) {
                alert('음식점을 입력하세요.');
                return;
            }

            const now = new Date();
            const date = now.toLocaleDateString();
            const day = now.toLocaleDateString('ko-KR', { weekday: 'long' });

            const newEntry = { date, day, food: recommendation, restaurant };

            lunchHistory.push(newEntry);
            localStorage.setItem('lunchHistory', JSON.stringify(lunchHistory));
            loadHistory();
            document.getElementById('restaurantInput').value = ''; // 음식점 입력 초기화
        }

        function updateLunch(index) {
            const updatedEntry = {
                date: lunchHistory[index].date,
                day: lunchHistory[index].day,
                food: document.getElementById(`food-${index}`).value,
                restaurant: document.getElementById(`restaurant-${index}`).value
            };

            lunchHistory[index] = updatedEntry;
            localStorage.setItem('lunchHistory', JSON.stringify(lunchHistory));
            loadHistory();
        }

        function deleteLunch(index) {
            lunchHistory.splice(index, 1);
            localStorage.setItem('lunchHistory', JSON.stringify(lunchHistory));
            loadHistory();
        }

        window.onload = loadHistory;
    </script>
</body>
</html>
